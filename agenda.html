<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Title -->
    <title>Odonto365</title>

    <!-- Favicon -->

    <!--==================== CSS ====================-->

    <!-- lucide -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <!-- CSS Perzonalizado -->
    <link rel="stylesheet" href="src/css/output.css" />
    <!--     <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              today: "#10b981",
              selected: "#3b82f6",
              unavailable: "#e5e7eb",
            },
          },
        },
      };
    </script> -->
  </head>
  <body class="bg-fondo-alternativo/30 min-h-screen">
    <!-- Header -->
    <header class="bg-transparent p-4 md:p-6 lg:p-8 max-w-7xl mx-auto">
      <div class="flex justify-between items-center">
        <!-- Botón Regresar -->
        <a
          href="/"
          class="px-4 md:px-6 lg:px-8 py-2 lg:py-3 flex justify-center items-center focus:outline-none gap-2 btn secundario border border-bordes"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-chevron-left-icon lucide-chevron-left w-5 h-5"
          >
            <path d="m15 18-6-6 6-6" />
          </svg>
          Regresar
        </a>

        <!-- Botón Historial de Citas -->
        <a
          href="/"
          class="px-4 md:px-6 lg:px-8 py-2 lg:py-3 flex justify-center items-center focus:outline-none gap-2 btn secundario border border-bordes"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="lucide lucide-clock4-icon lucide-clock-4 w-5 h-5"
          >
            <path d="M12 6v6l4 2" />
            <circle cx="12" cy="12" r="10" />
          </svg>
          Historial de Citas
        </a>
      </div>
    </header>

    <!-- Contenido Principal -->
    <main class="p-4 md:p-6 lg:p-8 max-w-7xl mx-auto">
      <div class="lg:grid lg:grid-cols-3 lg:gap-8">
        <!-- Columna Izquierda: Calendario y Leyenda -->
        <div class="lg:col-span-2">
          <!-- Leyenda expandida con icono de calendario -->
          <div class="bg-white p-4 rounded-xl shadow-sm mb-6">
            <div class="flex justify-between items-center text-sm">
              <div class="flex items-center space-x-2">
                <div class="bg-gray-100 p-2 rounded">
                  <svg
                    class="w-4 h-4 text-gray-700"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path
                      stroke-linecap="round"
                      stroke-linejoin="round"
                      stroke-width="2"
                      d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
                    ></path>
                  </svg>
                </div>
                <span class="text-gray-600"></span>
              </div>
              <div class="flex items-center space-x-2">
                <div class="w-4 h-4 bg-today rounded"></div>
                <span class="text-gray-600">Hoy</span>
              </div>
              <div class="flex items-center space-x-2">
                <div class="w-4 h-4 bg-selected rounded"></div>
                <span class="text-gray-600">Seleccionado</span>
              </div>
              <div class="flex items-center space-x-2">
                <div class="w-4 h-4 bg-unavailable rounded"></div>
                <span class="text-gray-600">No disponible</span>
              </div>
            </div>
          </div>

          <!-- Navegador de Meses/Días -->
          <div class="flex justify-between items-center mb-4">
            <button
              id="prevDays"
              class="p-2 rounded-lg hover:bg-gray-200 transition-colors"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                ></path>
              </svg>
            </button>
            <span
              id="monthDisplay"
              class="text-lg font-semibold text-gray-800"
            ></span>
            <button
              id="nextDays"
              class="p-2 rounded-lg hover:bg-gray-200 transition-colors"
            >
              <svg
                class="w-5 h-5"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                ></path>
              </svg>
            </button>
          </div>

          <!-- Días de la Semana -->
          <div id="daysContainer" class="grid grid-cols-4 gap-2 mb-6">
            <!-- Los días se generarán dinámicamente por JS -->
          </div>

          <!-- Horarios -->
          <div id="timeSlotsContainer" class="grid grid-cols-4 gap-2 mb-6">
            <!-- Los horarios se generarán dinámicamente por JS -->
          </div>
        </div>

        <!-- Columna Derecha: Resumen de la Cita -->
        <div class="mt-6 lg:mt-0">
          <div class="bg-fondo-principal p-6 rounded-xl shadow-sm">
            <h3 class="mb-6">Resumen de la Cita</h3>

            <!-- Especialidad -->
            <div class="mb-4">
              <h5 class="mb-2">Especialidad</h5>
              <div
                class="bg-gray-100 rounded-lg px-4 py-2 font-medium text-base md:text-lg"
              >
                Cardiología
              </div>
            </div>

            <!-- Especialista -->
            <div class="mb-4">
              <h3 class="text-gray-600 text-sm font-medium mb-2">
                Especialista
              </h3>
              <div class="flex items-center space-x-2">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="24"
                  height="24"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="currentColor"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  class="lucide lucide-stethoscope-icon lucide-stethoscope w-4 h-4 md:w-5 md:h-5 lg:w-6 lg:h-6 text-titulos/55"
                >
                  <path d="M11 2v2" />
                  <path d="M5 2v2" />
                  <path
                    d="M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1"
                  />
                  <path d="M8 15a6 6 0 0 0 12 0v-3" />
                  <circle cx="20" cy="10" r="2" />
                </svg>
                <p>Dr. María González</p>
              </div>
            </div>

            <!-- Fecha y Hora -->
            <div class="mb-4">
              <h5 class="mb-2">Fecha y Hora</h5>
              <div class="space-y-2">
                <div class="flex items-center gap-2">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="lucide lucide-calendar-icon lucide-calendar w-4 h-4 md:w-5 md:h-5 lg:w-6 lg:h-6 text-titulos/55"
                  >
                    <path d="M8 2v4" />
                    <path d="M16 2v4" />
                    <rect width="18" height="18" x="3" y="4" rx="2" />
                    <path d="M3 10h18" />
                  </svg>
                  <p id="summaryDate">martes, 22 de julio de 2025</p>
                </div>
                <div class="flex items-center gap-2">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="24"
                    height="24"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    class="lucide lucide-clock4-icon lucide-clock-4 w-4 h-4 md:w-5 md:h-5 lg:w-6 lg:h-6 text-titulos/55"
                  >
                    <path d="M12 6v6l4 2" />
                    <circle cx="12" cy="12" r="10" />
                  </svg>
                  <p id="summaryTime">16:00</p>
                </div>
              </div>
            </div>

            <!-- Duración -->
            <div class="mb-6">
              <h5 class="mb-2">Duración</h5>
              <p>45 minutos</p>
            </div>

            <!-- Separador -->
            <hr class="border-gray-200 mb-6" />

            <!-- Total a pagar -->
            <div class="mb-6">
              <div class="flex justify-between items-center mb-2">
                <h5>Total a pagar:</h5>
                <h5 class="text-green-600">$150.00</h5>
              </div>
              <p>Consulta especializada</p>
            </div>

            <!-- Botón Proceder al Pago -->
            <a
              href="agenda.html"
              class="px-4 md:px-6 lg:px-8 py-2 lg:py-3 flex justify-center items-center focus:outline-none gap-2 btn primario w-full cursor-pointer"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="24"
                height="24"
                viewBox="0 0 24 24"
                fill="none"
                stroke="currentColor"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-credit-card-icon lucide-credit-card w-5 h-5"
              >
                <rect width="20" height="14" x="2" y="5" rx="2" />
                <line x1="2" x2="22" y1="10" y2="10" />
              </svg>
              Proceder al Pago
            </a>

            <!-- Términos y condiciones -->
            <p class="font-body text-textos text-sm lg:text-base">
              Al proceder al pago, aceptas nuestros términos y condiciones
            </p>
          </div>
        </div>
      </div>
    </main>

    <script>
      class AgendaApp {
        constructor() {
          // Establece el inicio del rango de 4 días para incluir el 25 de julio de 2025
          // Si hoy es 29 de julio de 2025, y queremos mostrar 22-25, necesitamos ajustar el inicio.
          // Para que el 25 de julio sea el 4to día (index 3), el primer día (index 0) debe ser el 22 de julio.
          this.currentDateRangeStart = new Date(2025, 6, 22); // 22 de julio de 2025
          this.today = new Date(); // Fecha actual para marcar "Hoy"

          this.selectedAppointment = {
            date: new Date(2025, 6, 25, 16, 0), // 25 de julio de 2025, 16:00
            specialty: "Cardiología",
            specialist: "Dr. María González",
            duration: "45 minutos",
            price: "$150.00",
          };

          this.unavailableSlots = [
            new Date(2025, 6, 24, 11, 0), // Jueves 24, 11:00
            new Date(2025, 6, 24, 14, 0), // Jueves 24, 14:00
            new Date(2025, 6, 24, 17, 0), // Jueves 24, 17:00
            new Date(2025, 6, 25, 12, 0), // Viernes 25, 12:00
            new Date(2025, 6, 25, 13, 0), // Viernes 25, 13:00
            new Date(2025, 6, 25, 17, 0), // Viernes 25, 17:00
          ];

          this.timeSlots = [];
          for (let hour = 8; hour <= 18; hour++) {
            this.timeSlots.push(`${hour.toString().padStart(2, "0")}:00`);
          }

          this.init();
        }

        init() {
          this.renderCalendar(); // Renderiza días y horarios
          this.renderMonthNavigation(); // Actualiza el mes en el navegador
          this.updateAppointmentSummary(); // Muestra el resumen al cargar
          this.bindEvents();
        }

        bindEvents() {
          document.getElementById("prevDays").addEventListener("click", () => {
            this.currentDateRangeStart.setDate(
              this.currentDateRangeStart.getDate() - 4
            );
            this.renderCalendar();
            this.renderMonthNavigation();
          });

          document.getElementById("nextDays").addEventListener("click", () => {
            this.currentDateRangeStart.setDate(
              this.currentDateRangeStart.getDate() + 4
            );
            this.renderCalendar();
            this.renderMonthNavigation();
          });
        }

        renderMonthNavigation() {
          const monthDisplay = document.getElementById("monthDisplay");
          const months = [
            "Enero",
            "Febrero",
            "Marzo",
            "Abril",
            "Mayo",
            "Junio",
            "Julio",
            "Agosto",
            "Septiembre",
            "Octubre",
            "Noviembre",
            "Diciembre",
          ];
          monthDisplay.textContent = `${
            months[this.currentDateRangeStart.getMonth()]
          } ${this.currentDateRangeStart.getFullYear()}`;
        }

        isSameDay(date1, date2) {
          return (
            date1.getDate() === date2.getDate() &&
            date1.getMonth() === date2.getMonth() &&
            date1.getFullYear() === date2.getFullYear()
          );
        }

        isSameDateTime(date1, date2) {
          return (
            this.isSameDay(date1, date2) &&
            date1.getHours() === date2.getHours() &&
            date1.getMinutes() === date2.getMinutes()
          );
        }

        renderCalendar() {
          const daysContainer = document.getElementById("daysContainer");
          const timeSlotsContainer =
            document.getElementById("timeSlotsContainer");
          daysContainer.innerHTML = "";
          timeSlotsContainer.innerHTML = "";

          const daysOfWeek = ["dom", "lun", "mar", "mié", "jue", "vie", "sáb"];
          const monthsShort = [
            "ene",
            "feb",
            "mar",
            "abr",
            "may",
            "jun",
            "jul",
            "ago",
            "sep",
            "oct",
            "nov",
            "dic",
          ];

          const currentDaysInView = [];

          // Renderizar los encabezados de los días
          for (let i = 0; i < 4; i++) {
            const currentDayDate = new Date(this.currentDateRangeStart);
            currentDayDate.setDate(this.currentDateRangeStart.getDate() + i);
            currentDaysInView.push(currentDayDate); // Guardar la fecha para usarla en los slots

            const dayElement = document.createElement("div");

            let bgColor = "bg-gray-100";
            let textColor = "text-gray-600";

            if (this.isSameDay(currentDayDate, this.today)) {
              bgColor = "bg-today";
              textColor = "text-white";
            }
            if (this.isSameDay(currentDayDate, this.selectedAppointment.date)) {
              bgColor = "bg-selected";
              textColor = "text-white";
            }

            dayElement.className = `${bgColor} ${textColor} p-4 rounded-xl text-center`;
            dayElement.innerHTML = `
                        <div class="font-medium text-sm">${
                          daysOfWeek[currentDayDate.getDay()]
                        }</div>
                        <div class="text-2xl font-bold">${currentDayDate.getDate()}</div>
                        <div class="text-sm">${
                          monthsShort[currentDayDate.getMonth()]
                        }</div>
                    `;

            daysContainer.appendChild(dayElement);
          }

          // Renderizar los slots de tiempo
          for (
            let timeIndex = 0;
            timeIndex < this.timeSlots.length;
            timeIndex++
          ) {
            const timeString = this.timeSlots[timeIndex];
            const [hour, minute] = timeString.split(":").map(Number);

            for (let dayIndex = 0; dayIndex < 4; dayIndex++) {
              const slotElement = document.createElement("div");
              const slotDateTime = new Date(currentDaysInView[dayIndex]);
              slotDateTime.setHours(hour, minute, 0, 0);

              let className =
                "bg-white border border-gray-200 p-3 rounded-lg text-center pointer-events-none cursor-not-allowed";

              // Verificar si es un slot no disponible
              const isUnavailable = this.unavailableSlots.some(
                (unavailableDate) =>
                  this.isSameDateTime(slotDateTime, unavailableDate)
              );

              if (isUnavailable) {
                className =
                  "bg-unavailable text-gray-400 p-3 rounded-lg text-center pointer-events-none cursor-not-allowed";
              }

              // Verificar si es el slot seleccionado
              if (
                this.isSameDateTime(slotDateTime, this.selectedAppointment.date)
              ) {
                className =
                  "bg-selected text-white p-3 rounded-lg text-center pointer-events-none cursor-not-allowed";
              }

              slotElement.className = className;
              slotElement.innerHTML = `<div class="font-medium">${timeString}</div>`;

              timeSlotsContainer.appendChild(slotElement);
            }
          }
        }

        updateAppointmentSummary() {
          const monthsLong = [
            "enero",
            "febrero",
            "marzo",
            "abril",
            "mayo",
            "junio",
            "julio",
            "agosto",
            "septiembre",
            "octubre",
            "noviembre",
            "diciembre",
          ];
          const daysLong = [
            "domingo",
            "lunes",
            "martes",
            "miércoles",
            "jueves",
            "viernes",
            "sábado",
          ];

          const selectedDate = this.selectedAppointment.date;
          const dateStr = `${
            daysLong[selectedDate.getDay()]
          }, ${selectedDate.getDate()} de ${
            monthsLong[selectedDate.getMonth()]
          } de ${selectedDate.getFullYear()}`;
          const timeStr = `${selectedDate
            .getHours()
            .toString()
            .padStart(2, "0")}:${selectedDate
            .getMinutes()
            .toString()
            .padStart(2, "0")}`;

          document.getElementById("summaryDate").textContent = dateStr;
          document.getElementById("summaryTime").textContent = timeStr;
        }
      }

      document.addEventListener("DOMContentLoaded", () => {
        new AgendaApp();
      });
    </script>
  </body>
</html>
